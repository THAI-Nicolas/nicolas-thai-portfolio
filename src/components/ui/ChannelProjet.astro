---
import ChannelEmpty from "../../assets/icones/channel-bloc.svg";

export interface Props {
  isEmpty?: boolean;
  projectCover?: string;
  projectTitle?: string;
  size?: "mobile" | "desktop";
  href?: string;
  onClick?: () => void;
}

const {
  isEmpty = true,
  projectCover,
  projectTitle,
  size = "desktop",
  href = "#",
  onClick,
} = Astro.props;

// Tailles dynamiques
const sizes = {
  mobile: {
    container: "w-[295px] h-[160px]",
  },
  desktop: {
    container: "w-[380px] h-[190px]",
  },
};

const currentSize = sizes[size] || sizes.desktop;
---

<div
  class={`${currentSize.container} cursor-pointer transition-all duration-200 ease-in-out group`}
  data-onclick={onClick ? "true" : undefined}
>
  <div class="relative w-full h-full wii-channel-container">
    <ChannelEmpty class="w-full h-full wii-channel-svg" />
    {
      !isEmpty && projectCover && (
        <div class="absolute inset-0 flex items-center justify-center">
          <img
            src={projectCover}
            alt={projectTitle || "Project cover"}
            class="object-contain wii-project-cover"
            style="width: calc(100% - 4px); height: calc(100% - 4px);"
          />
        </div>
      )
    }
  </div>
</div>

<style>
  /* Suppression complète de tous les fonds */
  .wii-channel-container {
    position: relative;
    background: transparent !important;
  }

  .wii-channel-container::before {
    display: none !important;
  }

  /* SVG avec bordure visible et hover effect */
  .wii-channel-svg {
    transition: color 0.2s ease-in-out;
    color: rgb(119, 117, 117);
    z-index: 3;
    background: transparent !important;
    stroke: rgb(119, 117, 117) !important;
    stroke-width: 2px !important;
    fill: transparent !important;
  }

  /* Hover effect sur les bordures */
  .group:hover .wii-channel-svg {
    color: var(--color-light-blue) !important;
    stroke: var(--color-light-blue) !important;
  }

  /* Style pour l'image du projet */
  .wii-project-cover {
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
  }

  /* Focus ring supprimé */
  div:focus {
    outline: none;
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const channels = document.querySelectorAll('div[data-onclick="true"]');

    channels.forEach((channel) => {
      channel.addEventListener("click", (e) => {
        console.log("Channel cliqué");
      });
    });
  });
</script>
