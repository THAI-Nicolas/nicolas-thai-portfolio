---
export interface Props {
  isVisible?: boolean;
  onClose?: () => void;
}

const { isVisible = false, onClose } = Astro.props;
---

<div
  class="parametres-overlay opacity-0 pointer-events-none fixed inset-0 z-[60]"
  style="transition: opacity 0.3s ease-in-out;"
>
  <!-- Backdrop sans flou -->
  <div class="bg-black/50 fixed inset-0 z-[70]" style="pointer-events: none;"></div>

  <!-- Container principal -->
  <div
    class="parametres-container fixed inset-0 z-[80] flex items-center justify-center p-4 md:p-8"
  >
    <div
      class="parametres-content w-full max-w-full md:max-w-6xl bg-background gaming-border relative overflow-hidden wood-texture max-h-[90vh] md:max-h-none overflow-y-auto"
      style="animation: fadeIn 0.3s ease-out; border-radius: 12px;"
    >
      <!-- Header gaming -->
      <div
        class="parametres-header relative flex items-center justify-between border-b-3 border-light-blue px-6 py-4 md:px-12 md:py-6"
        style="box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08), inset 0 1px 0 rgba(255, 255, 255, 0.8), inset 0 -1px 2px rgba(0, 0, 0, 0.05); background-color: color-mix(in srgb, var(--color-background) 80%, white);"
      >
        <div class="flex items-center gap-2 md:gap-4">
          <svg
            class="w-8 h-8 text-light-blue"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"
            ></path>
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
          </svg>
          <h2
            class="text-2xl font-bold text-text-gray tracking-[0.15em] uppercase"
          >
            Paramètres
          </h2>
        </div>
        <button
          id="parametres-close-button"
          data-small-button
          class="cursor-pointer close-button w-8 h-8 md:w-12 md:h-12 border-2 border-light-blue hover:border-dark-blue bg-white hover:bg-light-blue/10 transition-all duration-300 flex items-center justify-center"
          aria-label="Fermer les paramètres"
        >
          <svg
            class="w-4 h-4 md:w-6 md:h-6 text-light-blue"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            stroke-width="2.5"
            aria-hidden="true"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>

      <!-- Content gaming -->
      <div
        class="parametres-body relative bg-background/80 px-6 py-4 md:px-12 md:py-8"
      >
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
          <!-- Colonne gauche -->
          <div style="display: flex; flex-direction: column; gap: 20px;">
            <!-- Section Audio -->
            <section class="parametres-section relative">
              <div class="flex items-center gap-3" style="margin-bottom: 20px;">
                <svg
                  class="w-5 h-5 text-light-blue"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"
                  ></path>
                </svg>
                <h3
                  class="text-base font-bold text-light-blue uppercase tracking-[0.15em] gaming-text"
                >
                  Audio
                </h3>
                <div
                  class="flex-1 h-px bg-gradient-to-r from-light-blue/50 to-transparent"
                >
                </div>
              </div>

              <div style="display: flex; flex-direction: column; gap: 12px;">
                <!-- Volume Général -->
                <div class="gaming-card group">
                  <div
                    class="flex items-center justify-between"
                    style="margin-bottom: 12px;"
                  >
                    <label
                      class="text-sm font-semibold text-text-gray tracking-wide flex items-center gap-2"
                    >
                      <svg
                        class="w-4 h-4 text-text-gray"
                        fill="currentColor"
                        viewBox="0 0 20 20"
                      >
                        <path
                          fill-rule="evenodd"
                          d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z"
                          clip-rule="evenodd"></path>
                      </svg>
                      Volume général
                    </label>
                    <div
                      class="slider-value text-sm font-bold text-light-blue tabular-nums"
                    >
                      30%
                    </div>
                  </div>
                  <input
                    type="range"
                    id="master-volume-slider"
                    min="0"
                    max="100"
                    value="30"
                    class="gaming-slider"
                  />
                </div>

                <!-- Musique d'ambiance -->
                <div class="gaming-card group">
                  <div
                    class="flex items-center justify-between"
                    style="margin-bottom: 12px;"
                  >
                    <label
                      class="text-sm font-semibold text-text-gray tracking-wide flex items-center gap-2"
                    >
                      <svg
                        class="w-4 h-4 text-text-gray"
                        fill="currentColor"
                        viewBox="0 0 20 20"
                      >
                        <path
                          d="M18 3a1 1 0 00-1.196-.98l-10 2A1 1 0 006 5v9.114A4.369 4.369 0 005 14c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V7.82l8-1.6v5.894A4.37 4.37 0 0015 12c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V3z"
                        ></path>
                      </svg>
                      Musique d'ambiance
                    </label>
                    <div
                      class="slider-value text-sm font-bold text-light-blue tabular-nums"
                    >
                      20%
                    </div>
                  </div>
                  <input
                    type="range"
                    id="music-volume-slider"
                    min="0"
                    max="100"
                    value="20"
                    class="gaming-slider"
                  />
                </div>

                <!-- Effets sonores -->
                <div class="gaming-card group">
                  <div
                    class="flex items-center justify-between"
                    style="margin-bottom: 12px;"
                  >
                    <label
                      class="text-sm font-semibold text-text-gray tracking-wide flex items-center gap-2"
                    >
                      <svg
                        class="w-4 h-4 text-text-gray"
                        fill="currentColor"
                        viewBox="0 0 20 20"
                      >
                        <path
                          d="M11 3a1 1 0 10-2 0v1a1 1 0 102 0V3zM15.657 5.757a1 1 0 00-1.414-1.414l-.707.707a1 1 0 001.414 1.414l.707-.707zM18 10a1 1 0 01-1 1h-1a1 1 0 110-2h1a1 1 0 011 1zM5.05 6.464A1 1 0 106.464 5.05l-.707-.707a1 1 0 00-1.414 1.414l.707.707zM5 10a1 1 0 01-1 1H3a1 1 0 110-2h1a1 1 0 011 1zM8 16v-1h4v1a2 2 0 11-4 0zM12 14c.015-.34.208-.646.477-.859a4 4 0 10-4.954 0c.27.213.462.519.477.859h4z"
                        ></path>
                      </svg>
                      Effets sonores
                    </label>
                    <div
                      class="slider-value text-sm font-bold text-light-blue tabular-nums"
                    >
                      50%
                    </div>
                  </div>
                  <input
                    type="range"
                    id="sfx-volume-slider"
                    min="0"
                    max="100"
                    value="50"
                    class="gaming-slider"
                  />
                </div>
              </div>
            </section>
          </div>

          <!-- Colonne droite -->
          <div style="display: flex; flex-direction: column; gap: 20px;">
            <!-- Section Interface -->
            <section class="parametres-section relative">
              <div class="flex items-center gap-3" style="margin-bottom: 20px;">
                <svg
                  class="w-5 h-5 text-light-blue"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
                  ></path>
                </svg>
                <h3
                  class="text-base font-bold text-light-blue uppercase tracking-[0.15em] gaming-text"
                >
                  Interface
                </h3>
                <div
                  class="flex-1 h-px bg-gradient-to-r from-light-blue/50 to-transparent"
                >
                </div>
              </div>

              <div style="display: flex; flex-direction: column; gap: 12px;">
                <!-- Curseur Wii -->
                <button
                  id="cursor-toggle-btn"
                  data-small-button
                  type="button"
                  class="gaming-card group cursor-pointer text-left"
                  style="transition: all 0.2s ease;"
                >
                  <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div class="flex items-center gap-2">
                      <svg class="w-4 h-4 text-text-gray" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"/>
                      </svg>
                      <span class="text-sm font-semibold text-text-gray tracking-wide">Curseur Wii</span>
                    </div>
                    <span id="cursor-status" class="text-sm font-bold text-light-blue">ON</span>
                  </div>
                </button>

                <!-- Thème -->
                <div style="background: white; border: 2px solid var(--color-light-blue); border-radius: 8px; padding: 16px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                  <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                    <svg style="width: 16px; height: 16px; color: var(--color-text-gray);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
                    </svg>
                    <div style="font-weight: 600; font-size: 13px; color: var(--color-text-gray);">Thème d'affichage</div>
                  </div>
                  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                    <button
                      id="theme-light-btn"
                      data-small-button
                      type="button"
                      style="padding: 10px; background: linear-gradient(145deg, rgba(52, 190, 237, 0.2), rgba(52, 190, 237, 0.1)); color: var(--color-light-blue); border: 2px solid var(--color-light-blue); border-radius: 6px; font-weight: 700; font-size: 11px; text-transform: uppercase; letter-spacing: 0.1em; cursor: pointer; transition: all 0.2s;"
                      onmouseover="this.style.background='linear-gradient(145deg, rgba(52, 190, 237, 0.3), rgba(52, 190, 237, 0.15))'"
                      onmouseout="this.style.background='linear-gradient(145deg, rgba(52, 190, 237, 0.2), rgba(52, 190, 237, 0.1))'"
                    >
                      Clair
                    </button>
                    <button
                      id="theme-dark-btn"
                      data-small-button
                      type="button"
                      style="padding: 10px; background: white; color: var(--color-dark-gray); border: 2px solid rgba(52, 190, 237, 0.3); border-radius: 6px; font-weight: 700; font-size: 11px; text-transform: uppercase; letter-spacing: 0.1em; cursor: pointer; transition: all 0.2s;"
                      onmouseover="this.style.borderColor='var(--color-light-blue)'; this.style.color='var(--color-light-blue)'"
                      onmouseout="this.style.borderColor='rgba(52, 190, 237, 0.3)'; this.style.color='var(--color-dark-gray)'"
                    >
                      Sombre
                    </button>
                  </div>
                </div>

                <!-- Langue -->
                <div style="background: white; border: 2px solid var(--color-light-blue); border-radius: 8px; padding: 16px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                  <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                    <svg style="width: 16px; height: 16px; color: var(--color-text-gray);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"></path>
                    </svg>
                    <div style="font-weight: 600; font-size: 13px; color: var(--color-text-gray);">Langue</div>
                  </div>
                  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                    <button
                      id="lang-fr-btn"
                      data-small-button
                      type="button"
                      style="padding: 10px; background: linear-gradient(145deg, rgba(52, 190, 237, 0.2), rgba(52, 190, 237, 0.1)); color: var(--color-light-blue); border: 2px solid var(--color-light-blue); border-radius: 6px; font-weight: 700; font-size: 11px; text-transform: uppercase; letter-spacing: 0.1em; cursor: pointer; transition: all 0.2s;"
                      onmouseover="this.style.background='linear-gradient(145deg, rgba(52, 190, 237, 0.3), rgba(52, 190, 237, 0.15))'"
                      onmouseout="this.style.background='linear-gradient(145deg, rgba(52, 190, 237, 0.2), rgba(52, 190, 237, 0.1))'"
                    >
                      Français
                    </button>
                    <button
                      id="lang-en-btn"
                      data-small-button
                      type="button"
                      style="padding: 10px; background: white; color: var(--color-dark-gray); border: 2px solid rgba(52, 190, 237, 0.3); border-radius: 6px; font-weight: 700; font-size: 11px; text-transform: uppercase; letter-spacing: 0.1em; cursor: pointer; transition: all 0.2s;"
                      onmouseover="this.style.borderColor='var(--color-light-blue)'; this.style.color='var(--color-light-blue)'"
                      onmouseout="this.style.borderColor='rgba(52, 190, 237, 0.3)'; this.style.color='var(--color-dark-gray)'"
                    >
                      English
                    </button>
                  </div>
                </div>

                
              </div>
            </section>
          </div>
        </div>
      </div>

      <!-- Footer gaming -->
      <div
        class="parametres-footer relative border-t-3 border-light-blue flex flex-col md:flex-row gap-3 md:gap-0 justify-between items-center px-6 py-4 md:px-12 md:py-6"
        style="box-shadow: 0 -4px 8px rgba(0, 0, 0, 0.08), inset 0 1px 0 rgba(255, 255, 255, 0.8), inset 0 -1px 2px rgba(0, 0, 0, 0.05); background-color: color-mix(in srgb, var(--color-background) 80%, white);"
      >
        <button
          id="parametres-reset-button"
          data-small-button
          class="cursor-pointer reset-btn font-bold text-xs border-2 transition-all duration-300 uppercase tracking-[0.15em] w-full md:w-auto"
          style="border-radius: 6px; padding: 10px 20px; color: var(--color-light-blue); background: white; border-color: var(--color-light-blue);"
        >
          <span class="flex items-center gap-2">
            <svg
              class="w-4 h-4"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
              ></path>
            </svg>
            Réinitialiser
          </span>
        </button>
        <button
          id="parametres-apply-button"
          data-small-button
          class="cursor-pointer apply-btn font-bold text-xs border-2 transition-all duration-300 uppercase tracking-[0.15em] w-full md:w-auto"
          style="border-radius: 6px; padding: 10px 28px; background: var(--color-light-blue); color: white; border-color: var(--color-light-blue);"
        >
          <span class="flex items-center gap-2">
            <svg
              class="w-4 h-4"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M5 13l4 4L19 7"></path>
            </svg>
            Enregistrer
          </span>
        </button>
      </div>
    </div>
  </div>
</div>

<style>
  /* Animations définies dans animations.css */

  /* Texture bois subtile avec effet de profondeur */
  .wood-texture {
    background-image: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.1) 0%,
        transparent 50%
      ),
      linear-gradient(90deg, rgba(139, 90, 43, 0.03) 1px, transparent 1px),
      linear-gradient(rgba(139, 90, 43, 0.03) 1px, transparent 1px);
    background-size:
      100% 100%,
      20px 20px,
      20px 20px;
  }

  /* Bordure simple */
  .gaming-border {
    border: 3px solid var(--color-light-blue);
  }

  .border-b-3 {
    border-bottom-width: 3px;
  }

  .border-t-3 {
    border-top-width: 3px;
  }

  /* Container - 3D uniquement sur desktop */
  @media (min-width: 768px) {
    .parametres-container {
      perspective: 1200px;
    }
    
    .parametres-content {
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.5), inset 0 -2px 8px rgba(0, 0, 0, 0.05);
      transform-style: preserve-3d;
      transition: transform 0.1s ease-out;
      will-change: transform;
    }
  }
  
  /* Mobile - aucun effet 3D */
  @media (max-width: 767px) {
    .parametres-content {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }
  }
  
  /* Close button avec effet 3D desktop */
  .close-button {
    border-radius: 6px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  @media (min-width: 768px) {
    .close-button {
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.8);
      transform-style: preserve-3d;
    }
    
    .close-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(52, 190, 237, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.9);
    }
    
    .close-button:active {
      transform: translateY(0);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.8);
    }
  }

  /* Cards avec effet 3D uniquement sur desktop */
  .gaming-card {
    padding: 12px;
    background: linear-gradient(
      145deg,
      rgba(255, 255, 255, 0.7) 0%,
      rgba(255, 255, 255, 0.5) 100%
    );
    border: 2px solid rgba(52, 190, 237, 0.3);
    border-radius: 8px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
  }
  
  @media (min-width: 768px) {
    .gaming-card {
      padding: 18px;
      box-shadow:
        0 2px 4px rgba(0, 0, 0, 0.08),
        0 4px 8px rgba(0, 0, 0, 0.04),
        inset 0 1px 0 rgba(255, 255, 255, 0.8),
        inset 0 -1px 2px rgba(0, 0, 0, 0.05);
    }
    
    .gaming-card::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border-radius: 8px;
      background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.3) 0%,
        transparent 50%,
        rgba(0, 0, 0, 0.02) 100%
      );
      pointer-events: none;
    }

    .gaming-card:hover {
      border-color: var(--color-light-blue);
      background: linear-gradient(
        145deg,
        rgba(255, 255, 255, 0.85) 0%,
        rgba(255, 255, 255, 0.65) 100%
      );
      transform: translateY(-2px);
      box-shadow:
        0 6px 12px rgba(52, 190, 237, 0.15),
        0 10px 20px rgba(0, 0, 0, 0.08),
        inset 0 1px 0 rgba(255, 255, 255, 0.9),
        inset 0 -1px 3px rgba(0, 0, 0, 0.08);
    }
  }
  
  /* Mobile - aucun effet 3D sur les cards */
  @media (max-width: 767px) {
    .gaming-card {
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
  }

  /* Slider avec effet 3D uniquement sur desktop */
  .gaming-slider {
    -webkit-appearance: none;
    appearance: none;
    width: 100%;
    height: 8px;
    background: linear-gradient(
      180deg,
      rgba(200, 200, 200, 0.8) 0%,
      rgba(230, 230, 235, 0.9) 100%
    );
    outline: none;
    cursor: pointer;
    border-radius: 8px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  @media (min-width: 768px) {
    .gaming-slider {
      box-shadow:
        inset 0 2px 4px rgba(0, 0, 0, 0.15),
        inset 0 -1px 2px rgba(255, 255, 255, 0.5),
        0 1px 2px rgba(255, 255, 255, 0.8);
    }
  }

  .gaming-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 22px;
    height: 22px;
    background: linear-gradient(
      145deg,
      var(--color-light-blue) 0%,
      var(--color-light-blue) 100%
    );
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    border-radius: 50%;
    border: 3px solid white;
  }
  
  @media (min-width: 768px) {
    .gaming-slider::-webkit-slider-thumb {
      box-shadow:
        0 3px 6px rgba(0, 0, 0, 0.2),
        0 1px 3px rgba(0, 0, 0, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.4);
    }

    .gaming-slider::-webkit-slider-thumb:hover {
      transform: scale(1.15);
      box-shadow:
        0 5px 10px rgba(52, 190, 237, 0.3),
        0 2px 5px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.5);
    }
  }
  
  @media (max-width: 767px) {
    .gaming-slider::-webkit-slider-thumb {
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
    }
  }

  .gaming-slider::-moz-range-thumb {
    width: 22px;
    height: 22px;
    background: linear-gradient(
      145deg,
      var(--color-light-blue) 0%,
      var(--color-light-blue) 100%
    );
    cursor: pointer;
    border: 3px solid white;
    border-radius: 50%;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  @media (min-width: 768px) {
    .gaming-slider::-moz-range-thumb {
      box-shadow:
        0 3px 6px rgba(0, 0, 0, 0.2),
        0 1px 3px rgba(0, 0, 0, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.4);
    }

    .gaming-slider::-moz-range-thumb:hover {
      transform: scale(1.15);
      box-shadow:
        0 5px 10px rgba(52, 190, 237, 0.3),
        0 2px 5px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.5);
    }
  }
  
  @media (max-width: 767px) {
    .gaming-slider::-moz-range-thumb {
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
    }
  }

  /* Toggle avec effet 3D uniquement sur desktop */
  .gaming-toggle {
    position: relative;
    display: inline-block;
    width: 56px;
    height: 28px;
  }

  .toggle-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(
      180deg,
      rgba(200, 200, 200, 0.9) 0%,
      rgba(230, 230, 235, 1) 100%
    );
    border: 2px solid rgba(52, 190, 237, 0.3);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    border-radius: 32px;
  }
  
  @media (min-width: 768px) {
    .toggle-slider {
      box-shadow:
        inset 0 2px 4px rgba(0, 0, 0, 0.15),
        inset 0 -1px 2px rgba(255, 255, 255, 0.5),
        0 1px 2px rgba(255, 255, 255, 0.8);
    }
  }

  .toggle-slider::before {
    content: "";
    position: absolute;
    height: 20px;
    width: 20px;
    left: 2px;
    top: 2px;
    background: linear-gradient(
      145deg,
      rgba(255, 255, 255, 1) 0%,
      rgba(240, 240, 245, 1) 100%
    );
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    border-radius: 50%;
  }
  
  @media (min-width: 768px) {
    .toggle-slider::before {
      box-shadow:
        0 2px 5px rgba(0, 0, 0, 0.25),
        0 1px 3px rgba(0, 0, 0, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.8);
    }
  }

  .toggle-input:checked + .toggle-slider {
    background: linear-gradient(
      180deg,
      var(--color-light-blue) 0%,
      var(--color-light-blue) 100%
    );
    border-color: var(--color-light-blue);
  }
  
  @media (min-width: 768px) {
    .toggle-input:checked + .toggle-slider {
      box-shadow:
        inset 0 2px 4px rgba(0, 0, 0, 0.2),
        inset 0 -1px 2px rgba(255, 255, 255, 0.3),
        0 1px 3px rgba(52, 190, 237, 0.4);
    }
  }

  .toggle-input:checked + .toggle-slider::before {
    transform: translateX(28px);
  }
  
  @media (min-width: 768px) {
    .toggle-input:checked + .toggle-slider::before {
      box-shadow:
        0 3px 6px rgba(52, 190, 237, 0.3),
        0 1px 3px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.9);
    }

    .toggle-slider:hover {
      border-color: var(--color-light-blue);
    }
  }

  /* Boutons avec effet 3D uniquement sur desktop */
  .gaming-btn {
    width: 100%;
    padding: 12px 16px;
    border: 2px solid rgba(52, 190, 237, 0.3);
    background: linear-gradient(
      145deg,
      rgba(255, 255, 255, 0.7) 0%,
      rgba(250, 250, 252, 0.5) 100%
    );
    color: var(--color-dark-gray);
    font-size: 11px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    border-radius: 6px;
    position: relative;
  }
  
  @media (min-width: 768px) {
    .gaming-btn {
      box-shadow:
        0 2px 4px rgba(0, 0, 0, 0.08),
        0 1px 2px rgba(0, 0, 0, 0.05),
        inset 0 1px 0 rgba(255, 255, 255, 0.8),
        inset 0 -1px 2px rgba(0, 0, 0, 0.05);
    }

    .gaming-btn:hover {
      border-color: var(--color-light-blue);
      background: linear-gradient(
        145deg,
        rgba(255, 255, 255, 0.9) 0%,
        rgba(250, 250, 252, 0.7) 100%
      );
      color: var(--color-light-blue);
      transform: translateY(-1px);
      box-shadow:
        0 4px 8px rgba(52, 190, 237, 0.15),
        0 2px 4px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.9),
        inset 0 -1px 2px rgba(0, 0, 0, 0.08);
    }
  }
  
  @media (max-width: 767px) {
    .gaming-btn {
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .gaming-btn:hover {
      border-color: var(--color-light-blue);
      color: var(--color-light-blue);
    }
  }

  .gaming-btn.active {
    background: linear-gradient(
      145deg,
      rgba(52, 190, 237, 0.2) 0%,
      rgba(52, 190, 237, 0.1) 100%
    );
    color: var(--color-light-blue);
    border-color: var(--color-light-blue);
  }
  
  @media (min-width: 768px) {
    .gaming-btn.active {
      box-shadow:
        inset 0 2px 4px rgba(52, 190, 237, 0.2),
        inset 0 -1px 2px rgba(255, 255, 255, 0.5),
        0 2px 4px rgba(52, 190, 237, 0.15);
    }
  }

  .gaming-btn:active {
    transform: translateY(0) translateZ(0);
  }
  
  @media (min-width: 768px) {
    .gaming-btn:active {
      box-shadow:
        inset 0 2px 4px rgba(0, 0, 0, 0.15),
        0 1px 2px rgba(0, 0, 0, 0.05);
    }
  }

  /* Boutons du footer avec effet 3D uniquement sur desktop */
  .reset-btn,
  .apply-btn {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  @media (min-width: 768px) {
    .reset-btn,
    .apply-btn {
      box-shadow:
        0 3px 6px rgba(0, 0, 0, 0.12),
        0 1px 3px rgba(0, 0, 0, 0.08),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }

    .reset-btn:hover {
      background: var(--color-light-blue) !important;
      color: white !important;
      transform: translateY(-2px);
      box-shadow:
        0 6px 12px rgba(52, 190, 237, 0.25),
        0 3px 6px rgba(0, 0, 0, 0.12),
        inset 0 1px 0 rgba(255, 255, 255, 0.4);
    }

    .apply-btn {
      box-shadow:
        0 4px 8px rgba(52, 190, 237, 0.25),
        0 2px 4px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }

    .apply-btn:hover {
      background: var(--color-dark-blue) !important;
      transform: translateY(-2px);
      box-shadow:
        0 6px 12px rgba(52, 190, 237, 0.35),
        0 3px 6px rgba(0, 0, 0, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.4);
    }

    .reset-btn:active,
    .apply-btn:active {
      transform: translateY(0);
      box-shadow:
        inset 0 2px 4px rgba(0, 0, 0, 0.2),
        0 1px 2px rgba(0, 0, 0, 0.1);
    }
  }
  
  @media (max-width: 767px) {
    .reset-btn,
    .apply-btn {
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    
    .reset-btn:hover {
      background: var(--color-light-blue) !important;
      color: white !important;
    }
    
    .apply-btn:hover {
      background: var(--color-dark-blue) !important;
    }
  }

  /* Utils */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }

  .tabular-nums {
    font-variant-numeric: tabular-nums;
  }

  /* Responsive */
  @media (max-width: 1024px) {
    .grid-cols-2 {
      grid-template-columns: 1fr;
    }
  }

  /* Boutons de thème */
  .theme-button {
    border: 2px solid transparent;
    transition: all 0.3s ease;
  }

  .theme-button.active {
    border-color: var(--color-light-blue);
    background: linear-gradient(
      145deg,
      rgba(52, 190, 237, 0.15) 0%,
      rgba(52, 190, 237, 0.05) 100%
    ) !important;
    box-shadow:
      0 0 0 1px var(--color-light-blue),
      0 4px 12px rgba(52, 190, 237, 0.2),
      inset 0 1px 0 rgba(255, 255, 255, 0.9) !important;
  }

  .theme-button.active svg {
    color: var(--color-dark-blue);
  }

  .theme-button:hover {
    border-color: var(--color-light-blue);
  }
</style>

<script>
  import { OverlayManager } from '../../scripts/overlay-manager';
  import { ParametresManager } from '../../scripts/parametres-manager';
  
  let parametresManager: ParametresManager | null = null;

  function initParametresOverlay() {
    const overlayManager = OverlayManager.getInstance();
    
    // Setup de l'overlay paramètres avec le bouton de fermeture custom
    overlayManager.setupOverlay('parametres', {
      closeButtonSelector: '#parametres-close-button'
    });
    
    // Recréer le gestionnaire de paramètres à chaque fois pour éviter les références DOM obsolètes
    parametresManager = new ParametresManager();
    
    // Gestion du curseur Wii avec bouton simple
    const cursorToggleBtn = document.getElementById('cursor-toggle-btn') as HTMLButtonElement;
    const cursorStatus = document.getElementById('cursor-status') as HTMLSpanElement;
    
    // Charger la préférence sauvegardée
    const savedCursor = localStorage.getItem('wiiCursor');
    let cursorEnabled = savedCursor !== 'disabled'; // Par défaut ON
    
    // Fonction pour mettre à jour le curseur et l'affichage
    function updateCursor(enabled: boolean) {
      if (enabled) {
        document.documentElement.classList.add('custom-cursor');
        if (cursorStatus) cursorStatus.textContent = 'ON';
      } else {
        document.documentElement.classList.remove('custom-cursor');
        if (cursorStatus) cursorStatus.textContent = 'OFF';
      }
    }
    
    // Initialiser l'état
    updateCursor(cursorEnabled);
    
    // Gestionnaire du bouton
    if (cursorToggleBtn) {
      cursorToggleBtn.addEventListener('click', () => {
        cursorEnabled = !cursorEnabled;
        updateCursor(cursorEnabled);
        localStorage.setItem('wiiCursor', cursorEnabled ? 'enabled' : 'disabled');
      });
    }
    
    // Gestion des boutons de thème
    const themeLightBtn = document.getElementById('theme-light-btn') as HTMLButtonElement;
    const themeDarkBtn = document.getElementById('theme-dark-btn') as HTMLButtonElement;
    
    const currentTheme = localStorage.getItem('theme') || 'light';
    
    function updateThemeButtons(theme: string) {
      if (theme === 'light') {
        themeLightBtn.style.background = 'linear-gradient(145deg, rgba(52, 190, 237, 0.2), rgba(52, 190, 237, 0.1))';
        themeLightBtn.style.color = 'var(--color-light-blue)';
        themeLightBtn.style.borderColor = 'var(--color-light-blue)';
        
        themeDarkBtn.style.background = 'white';
        themeDarkBtn.style.color = 'var(--color-dark-gray)';
        themeDarkBtn.style.borderColor = 'rgba(52, 190, 237, 0.3)';
      } else {
        themeDarkBtn.style.background = 'linear-gradient(145deg, rgba(52, 190, 237, 0.2), rgba(52, 190, 237, 0.1))';
        themeDarkBtn.style.color = 'var(--color-light-blue)';
        themeDarkBtn.style.borderColor = 'var(--color-light-blue)';
        
        themeLightBtn.style.background = 'white';
        themeLightBtn.style.color = 'var(--color-dark-gray)';
        themeLightBtn.style.borderColor = 'rgba(52, 190, 237, 0.3)';
      }
    }
    
    updateThemeButtons(currentTheme);
    
    themeLightBtn?.addEventListener('click', () => {
      localStorage.setItem('theme', 'light');
      updateThemeButtons('light');
    });
    
    themeDarkBtn?.addEventListener('click', () => {
      localStorage.setItem('theme', 'dark');
      updateThemeButtons('dark');
    });
    
    // Gestion des boutons de langue
    const langFrBtn = document.getElementById('lang-fr-btn') as HTMLButtonElement;
    const langEnBtn = document.getElementById('lang-en-btn') as HTMLButtonElement;
    
    const currentLang = localStorage.getItem('language') || 'fr';
    
    function updateLangButtons(lang: string) {
      if (lang === 'fr') {
        langFrBtn.style.background = 'linear-gradient(145deg, rgba(52, 190, 237, 0.2), rgba(52, 190, 237, 0.1))';
        langFrBtn.style.color = 'var(--color-light-blue)';
        langFrBtn.style.borderColor = 'var(--color-light-blue)';
        
        langEnBtn.style.background = 'white';
        langEnBtn.style.color = 'var(--color-dark-gray)';
        langEnBtn.style.borderColor = 'rgba(52, 190, 237, 0.3)';
      } else {
        langEnBtn.style.background = 'linear-gradient(145deg, rgba(52, 190, 237, 0.2), rgba(52, 190, 237, 0.1))';
        langEnBtn.style.color = 'var(--color-light-blue)';
        langEnBtn.style.borderColor = 'var(--color-light-blue)';
        
        langFrBtn.style.background = 'white';
        langFrBtn.style.color = 'var(--color-dark-gray)';
        langFrBtn.style.borderColor = 'rgba(52, 190, 237, 0.3)';
      }
    }
    
    updateLangButtons(currentLang);
    
    langFrBtn?.addEventListener('click', () => {
      localStorage.setItem('language', 'fr');
      updateLangButtons('fr');
    });
    
    langEnBtn?.addEventListener('click', () => {
      localStorage.setItem('language', 'en');
      updateLangButtons('en');
    });
    
    console.log("Parametres overlay initialized with managers!");
  }

  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", initParametresOverlay);
  } else {
    initParametresOverlay();
  }

  document.addEventListener("astro:page-load", initParametresOverlay);
</script>
