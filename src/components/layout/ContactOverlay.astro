---
import ContactBouton from "../boutons/ContactBouton.astro";
import MainBouton from "../boutons/MainBouton.astro";
import SmallBouton from "../boutons/SmallBouton.astro";

export interface Props {
  isVisible?: boolean;
  onClose?: () => void;
}

const { isVisible = false, onClose } = Astro.props;
---

<div
  class="contact-overlay opacity-0 pointer-events-none fixed inset-0 z-[60]"
  style="transition: opacity 0.3s ease-in-out;"
>
  <div class="bg-black/50 fixed inset-0 z-[70] overflow-hidden"></div>

  <div
    class="contact-container fixed inset-0 z-[80] flex items-center justify-center overflow-y-auto md:overflow-hidden"
    id="contact-container"
  >
    <!-- Layout mobile/tablette : vertical -->
    <div class="flex flex-col lg:hidden w-full h-full py-4 px-4 gap-6 overflow-y-auto">
      <!-- Bouton retour en haut à droite -->
      <div class="flex justify-end pt-0 md:pt-2">
        <div id="contact-return-button-mobile" class="contact-return-button">
          <MainBouton type="retour" size="mobile" />
        </div>
      </div>

      <!-- Formulaire simple centré -->
      <div class="flex-1 flex items-center justify-center">
        <div class="mobile-form-wrapper w-[75%] md:w-[55%]">
          <div class="mobile-form-content bg-white rounded-2xl p-4 border-3 border-light-blue shadow-xl">
            <div class="mobile-form-header mb-4 pb-3 border-b-3 border-light-blue">
              <h2 class="text-xl font-bold text-light-blue tracking-wider uppercase text-center">
                FORMULAIRE
              </h2>
            </div>

            <form class="mobile-form" id="contact-form-mobile">
              <div class="flex flex-col gap-3">
                <div>
                  <label for="mobile-prenom" class="block text-xs font-bold mb-1 text-text-gray tracking-wide">
                    Prénom
                  </label>
                  <input
                    type="text"
                    id="mobile-prenom"
                    name="prenom"
                    data-sync="prenom"
                    placeholder="Ex: Jean"
                    class="mobile-input w-full px-3 py-2 border-2 border-light-blue rounded-lg focus:outline-none focus:border-dark-blue text-sm"
                  />
                </div>

                <div>
                  <label for="mobile-nom" class="block text-xs font-bold mb-1 text-text-gray tracking-wide">
                    Nom
                  </label>
                  <input
                    type="text"
                    id="mobile-nom"
                    name="nom"
                    data-sync="nom"
                    placeholder="Ex: Dupont"
                    class="mobile-input w-full px-3 py-2 border-2 border-light-blue rounded-lg focus:outline-none focus:border-dark-blue text-sm"
                  />
                </div>

                <div>
                  <label for="mobile-email" class="block text-xs font-bold mb-1 text-text-gray tracking-wide">
                    Email
                  </label>
                  <input
                    type="email"
                    id="mobile-email"
                    name="email"
                    data-sync="email"
                    placeholder="Ex: jean.dupont@email.com"
                    class="mobile-input w-full px-3 py-2 border-2 border-light-blue rounded-lg focus:outline-none focus:border-dark-blue text-sm"
                  />
                </div>

                <div>
                  <label for="mobile-sujet" class="block text-xs font-bold mb-1 text-text-gray tracking-wide">
                    Sujet
                  </label>
                  <input
                    type="text"
                    id="mobile-sujet"
                    name="sujet"
                    data-sync="sujet"
                    placeholder="Ex: Offre d'alternance..."
                    class="mobile-input w-full px-3 py-2 border-2 border-light-blue rounded-lg focus:outline-none focus:border-dark-blue text-sm"
                  />
                </div>

                <div>
                  <label for="mobile-message" class="block text-xs font-bold mb-1 text-text-gray tracking-wide">
                    Message
                  </label>
                  <textarea
                    rows="3"
                    id="mobile-message"
                    name="message"
                    data-sync="message"
                    placeholder="Ex: Offre d'alternance en dev web..."
                    class="mobile-input w-full px-3 py-2 border-2 border-light-blue rounded-lg focus:outline-none focus:border-dark-blue text-sm resize-none"
                  ></textarea>
                </div>

                <button
                  type="submit"
                  class="mobile-submit-btn w-full bg-light-blue text-white border-2 border-light-blue py-3 rounded-xl font-bold transition-all duration-300 text-sm uppercase tracking-widest hover:bg-white hover:text-light-blue"
                >
                  ENVOYER
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- 4 ContactBoutons en bas -->
      <div class="flex justify-center gap-2">
        <ContactBouton type="email" />
        <ContactBouton type="github" />
        <ContactBouton type="linkedin" />
        <ContactBouton type="instagram" />
      </div>
    </div>

    <!-- Layout desktop/laptop : horizontal -->
    <div class="hidden lg:flex items-stretch gap-8 xl:gap-60">
      <!-- Partie gauche - 4 ContactBoutons -->
      <div
        class="flex flex-col items-center justify-end flex-shrink-0 mt-4 mb-2 xl:mt-8 xl:mb-4"
      >
        <div class="flex flex-col items-center gap-4 xl:gap-8">
          <ContactBouton type="email" />
          <ContactBouton type="github" />
          <ContactBouton type="linkedin" />
          <ContactBouton type="instagram" />
        </div>
      </div>

      <!-- Partie centre - Pancarte avec formulaire -->
      <div class="contact-center flex justify-center items-start pt-2 xl:pt-4 flex-1">
        <div class="sign-wrapper relative">
          <!-- Chaînes de suspension gauche -->
          <div class="chain chain-left"></div>
          <!-- Chaînes de suspension droite -->
          <div class="chain chain-right"></div>

          <!-- Pancarte style jeu vidéo -->
          <div class="gaming-sign" id="gaming-sign">
            <!-- Crochets pour les chaînes -->
            <div class="hook hook-left"></div>
            <div class="hook hook-right"></div>

            <!-- Contenu de la pancarte -->
            <div class="sign-content">
              <div class="sign-header">
                <h2
                  class="text-xl xl:text-3xl font-bold text-light-blue tracking-wider uppercase"
                >
                  FORMULAIRE
                </h2>
                <!-- Bouton Zoom -->
                <div class="zoom-btn-wrapper">
                  <SmallBouton type="zoom" size="laptop" id="zoom-button" />
                </div>
              </div>

              <form class="sign-form" id="contact-form">
                <div class="grid grid-cols-2 gap-2 xl:gap-4">
                  <div>
                    <label
                      for="gaming-prenom"
                      class="block text-xs xl:text-sm font-bold mb-1 xl:mb-2 text-text-gray tracking-wide"
                    >
                      Prénom
                    </label>
                    <input
                      type="text"
                      id="gaming-prenom"
                      name="prenom"
                      data-sync="prenom"
                      placeholder="Ex: Jean"
                      class="gaming-input w-full px-2 py-2 xl:px-4 xl:py-3 border-2 border-light-blue rounded-lg focus:outline-none focus:border-dark-blue text-xs xl:text-sm"
                    />
                  </div>
                  <div>
                    <label
                      for="gaming-nom"
                      class="block text-xs xl:text-sm font-bold mb-1 xl:mb-2 text-text-gray tracking-wide"
                    >
                      Nom
                    </label>
                    <input
                      type="text"
                      id="gaming-nom"
                      name="nom"
                      data-sync="nom"
                      placeholder="Ex: Dupont"
                      class="gaming-input w-full px-2 py-2 xl:px-4 xl:py-3 border-2 border-light-blue rounded-lg focus:outline-none focus:border-dark-blue text-xs xl:text-sm"
                    />
                  </div>
                </div>

                <div>
                  <label
                    for="gaming-email"
                    class="block text-xs xl:text-sm font-bold mb-1 xl:mb-2 text-text-gray tracking-wide"
                  >
                    Email
                  </label>
                  <input
                    type="email"
                    id="gaming-email"
                    name="email"
                    data-sync="email"
                    placeholder="Ex: jean.dupont@email.com"
                    class="gaming-input w-full px-2 py-2 xl:px-4 xl:py-3 border-2 border-light-blue rounded-lg focus:outline-none focus:border-dark-blue text-xs xl:text-sm"
                  />
                </div>

                <div>
                  <label
                    for="gaming-sujet"
                    class="block text-xs xl:text-sm font-bold mb-1 xl:mb-2 text-text-gray tracking-wide"
                  >
                    Sujet
                  </label>
                  <input
                    type="text"
                    id="gaming-sujet"
                    name="sujet"
                    data-sync="sujet"
                    placeholder="Ex: Offre d'alternance..."
                    class="gaming-input w-full px-2 py-2 xl:px-4 xl:py-3 border-2 border-light-blue rounded-lg focus:outline-none focus:border-dark-blue text-xs xl:text-sm"
                  />
                </div>

                <div>
                  <label
                    for="gaming-message"
                    class="block text-xs xl:text-sm font-bold mb-1 xl:mb-2 text-text-gray tracking-wide"
                  >
                    Message
                  </label>
                  <textarea
                    rows="3"
                    id="gaming-message"
                    name="message"
                    data-sync="message"
                    placeholder="Ex: Offre d'alternance en dev web..."
                    class="gaming-input w-full px-2 py-2 xl:px-4 xl:py-3 border-2 border-light-blue rounded-lg focus:outline-none focus:border-dark-blue text-xs xl:text-sm resize-none"
                  ></textarea>
                </div>

                <button
                  type="submit"
                  class="gaming-submit-btn w-full bg-light-blue text-white border-2 border-light-blue py-2 xl:py-4 rounded-xl font-bold transition-all duration-300 text-sm xl:text-base uppercase tracking-widest hover:bg-white hover:text-light-blue hover:border-light-blue"
                >
                  ENVOYER
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>

      <!-- Feuille de papier zoomée qui sort du bas -->
      <div class="paper-sheet" id="paper-sheet">
        <div class="paper-content">
          <div class="paper-header">
            <h2
              class="text-2xl xl:text-4xl font-bold text-light-blue tracking-wider uppercase"
            >
              FORMULAIRE
            </h2>
            <div class="dezoom-btn-wrapper">
              <SmallBouton type="dezoom" size="laptop" id="dezoom-button" />
            </div>
          </div>

          <form class="paper-form" id="paper-form">
            <div class="grid grid-cols-2 gap-3 xl:gap-6">
              <div>
                <label
                  for="paper-prenom"
                  class="block text-sm xl:text-base font-bold mb-2 xl:mb-3 text-text-gray tracking-wide"
                >
                  Prénom
                </label>
                <input
                  type="text"
                  id="paper-prenom"
                  name="prenom"
                  data-sync="prenom"
                  placeholder="Ex: Jean"
                  class="paper-input w-full px-3 py-2 xl:px-5 xl:py-4 border-2 border-light-blue rounded-lg focus:outline-none focus:border-dark-blue text-base xl:text-lg"
                />
              </div>
              <div>
                <label
                  for="paper-nom"
                  class="block text-sm xl:text-base font-bold mb-2 xl:mb-3 text-text-gray tracking-wide"
                >
                  Nom
                </label>
                <input
                  type="text"
                  id="paper-nom"
                  name="nom"
                  data-sync="nom"
                  placeholder="Ex: Dupont"
                  class="paper-input w-full px-3 py-2 xl:px-5 xl:py-4 border-2 border-light-blue rounded-lg focus:outline-none focus:border-dark-blue text-base xl:text-lg"
                />
              </div>
            </div>

            <div>
              <label
                for="paper-email"
                class="block text-sm xl:text-base font-bold mb-2 xl:mb-3 text-text-gray tracking-wide"
              >
                Email
              </label>
              <input
                type="email"
                id="paper-email"
                name="email"
                data-sync="email"
                placeholder="Ex: jean.dupont@email.com"
                class="paper-input w-full px-3 py-2 xl:px-5 xl:py-4 border-2 border-light-blue rounded-lg focus:outline-none focus:border-dark-blue text-base xl:text-lg"
              />
            </div>

            <div>
              <label
                for="paper-sujet"
                class="block text-sm xl:text-base font-bold mb-2 xl:mb-3 text-text-gray tracking-wide"
              >
                Sujet
              </label>
              <input
                type="text"
                id="paper-sujet"
                name="sujet"
                data-sync="sujet"
                placeholder="Ex: Offre d'alternance..."
                class="paper-input w-full px-3 py-2 xl:px-5 xl:py-4 border-2 border-light-blue rounded-lg focus:outline-none focus:border-dark-blue text-base xl:text-lg"
              />
            </div>

            <div>
              <label
                for="paper-message"
                class="block text-sm xl:text-base font-bold mb-2 xl:mb-3 text-text-gray tracking-wide"
              >
                Message
              </label>
              <textarea
                rows="6"
                id="paper-message"
                name="message"
                data-sync="message"
                placeholder="Ex: Offre d'alternance en dev web..."
                class="paper-input w-full px-3 py-2 xl:px-5 xl:py-4 border-2 border-light-blue rounded-lg focus:outline-none focus:border-dark-blue text-base xl:text-lg resize-none"
              ></textarea>
            </div>

            <button
              type="submit"
              class="paper-submit-btn w-full bg-light-blue text-white border-2 border-light-blue py-3 xl:py-5 rounded-xl font-bold transition-all duration-300 text-base xl:text-lg uppercase tracking-widest hover:bg-white hover:text-light-blue hover:border-light-blue"
            >
              ENVOYER
            </button>
          </form>
        </div>
      </div>

      <!-- Partie droite - MainBouton Retour -->
      <div class="flex flex-col items-center justify-start flex-shrink-0 mt-4 xl:mt-8">
        <!-- Version laptop -->
        <div id="contact-return-button-laptop" class="contact-return-button 2xl:hidden">
          <MainBouton type="retour" size="laptop" />
        </div>
        <!-- Version desktop -->
        <div id="contact-return-button-desktop" class="contact-return-button hidden 2xl:block">
          <MainBouton type="retour" size="desktop" />
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .contact-overlay {
    transition: opacity 0.3s ease-in-out;
  }

  .contact-container {
    scrollbar-width: thin;
  }

  /* Wrapper de la pancarte */
  .sign-wrapper {
    width: 500px;
    perspective: 1000px;
  }

  @media (min-width: 1536px) {
    .sign-wrapper {
      width: 1000px;
    }
  }

  /* Mobile form styles */
  .mobile-form-wrapper {
    width: 100%;
  }

  .mobile-form-content {
    background: white;
  }

  .border-b-3 {
    border-bottom-width: 3px;
  }

  .border-3 {
    border-width: 3px;
  }

  .mobile-input {
    background: white;
    font-family: "raleway", sans-serif;
    transition: all 0.2s ease;
  }

  .mobile-input:focus {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(52, 190, 237, 0.3);
  }

  .mobile-submit-btn:hover {
    background: white !important;
    color: var(--color-light-blue) !important;
  }



  /* Chaînes de suspension */
  .chain {
    position: absolute;
    width: 5px;
    height: 220px;
    top: -212px;
    background: #8a8a8a;
    background-image: repeating-linear-gradient(
      0deg,
      #8a8a8a 0px,
      #8a8a8a 6px,
      #7a7a7a 6px,
      #7a7a7a 10px
    );
    box-shadow:
      inset 2px 0 4px rgba(0, 0, 0, 0.3),
      2px 0 4px rgba(0, 0, 0, 0.2);
    opacity: 0;
    transform: translateY(-100px);
  }

  @media (min-width: 1536px) {
    .chain {
      width: 8px;
      height: 350px;
      top: -338px;
      background-image: repeating-linear-gradient(
        0deg,
        #8a8a8a 0px,
        #8a8a8a 8px,
        #7a7a7a 8px,
        #7a7a7a 12px
      );
    }
  }

  .chain.show {
    animation: 
      chain-drop 2s cubic-bezier(0.34, 1.56, 0.64, 1) forwards,
      chain-swing 4s ease-in-out 2s infinite;
  }

  .chain-left {
    left: 60px;
  }

  .chain-right {
    right: 60px;
    box-shadow:
      inset -2px 0 4px rgba(0, 0, 0, 0.3),
      -2px 0 4px rgba(0, 0, 0, 0.2);
  }

  @media (min-width: 1536px) {
    .chain-left {
      left: 90px;
    }

    .chain-right {
      right: 90px;
    }
  }

  /* Pancarte style jeu vidéo */
  .gaming-sign {
    width: 100%;
    background: linear-gradient(145deg, #d4a574 0%, #b8926a 50%, #a17d58 100%);
    border: 4px solid #8b6f47;
    border-radius: 16px;
    padding: 18px;
    box-shadow:
      0 20px 50px rgba(0, 0, 0, 0.4),
      inset 0 2px 0 rgba(255, 255, 255, 0.3),
      inset 0 -4px 12px rgba(0, 0, 0, 0.2);
    position: relative;
    transform-origin: top center;
    opacity: 0;
    transform: translateY(-150px) rotateX(-15deg);
    transition:
      transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1),
      box-shadow 0.6s ease;
  }

  @media (min-width: 1536px) {
    .gaming-sign {
      border: 6px solid #8b6f47;
      border-radius: 20px;
      padding: 40px;
    }
  }

  .gaming-sign.show {
    animation: 
      sign-drop 2s cubic-bezier(0.34, 1.56, 0.64, 1) forwards,
      sign-sway 4s ease-in-out 2s infinite;
  }

  .gaming-sign::before {
    content: "";
    position: absolute;
    inset: 8px;
    border: 2px solid rgba(139, 111, 71, 0.4);
    border-radius: 12px;
    pointer-events: none;
  }

  @media (min-width: 1536px) {
    .gaming-sign::before {
      inset: 12px;
      border: 3px solid rgba(139, 111, 71, 0.4);
      border-radius: 14px;
    }
  }

  /* Crochets pour les chaînes */
  .hook {
    position: absolute;
    top: -4px;
    width: 20px;
    height: 20px;
    background: radial-gradient(circle, #6a6a6a 0%, #4a4a4a 100%);
    border: 2px solid #3a3a3a;
    border-radius: 50%;
    box-shadow:
      0 3px 6px rgba(0, 0, 0, 0.4),
      inset 0 2px 4px rgba(255, 255, 255, 0.2);
  }

  @media (min-width: 1536px) {
    .hook {
      top: -6px;
      width: 30px;
      height: 30px;
      border: 3px solid #3a3a3a;
      box-shadow:
        0 4px 8px rgba(0, 0, 0, 0.4),
        inset 0 2px 4px rgba(255, 255, 255, 0.2);
    }
  }

  .hook::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 8px;
    height: 8px;
    background: #2a2a2a;
    border-radius: 50%;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.6);
  }

  @media (min-width: 1536px) {
    .hook::after {
      width: 12px;
      height: 12px;
    }
  }

  .hook-left {
    left: 50px;
  }

  .hook-right {
    right: 50px;
  }

  @media (min-width: 1536px) {
    .hook-left {
      left: 74px;
    }

    .hook-right {
      right: 74px;
    }
  }

  /* Contenu de la pancarte */
  .sign-content {
    background: white;
    border-radius: 12px;
    padding: 16px;
    border: 3px solid var(--color-light-blue);
    box-shadow:
      0 6px 20px rgba(0, 0, 0, 0.15),
      inset 0 1px 0 rgba(255, 255, 255, 0.9);
  }

  @media (min-width: 1536px) {
    .sign-content {
      border-radius: 16px;
      padding: 32px;
      border: 4px solid var(--color-light-blue);
      box-shadow:
        0 8px 24px rgba(0, 0, 0, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.9);
    }
  }

  .sign-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
    padding-bottom: 10px;
    border-bottom: 3px solid var(--color-light-blue);
  }

  @media (min-width: 1536px) {
    .sign-header {
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 4px solid var(--color-light-blue);
    }
  }

  .zoom-btn-wrapper {
    position: relative;
    z-index: 500;
    transition: transform 0.2s ease;
  }

  .zoom-btn-wrapper:hover {
    transform: scale(1.15) rotate(5deg);
  }

  .zoom-btn-wrapper:active {
    transform: scale(1.05) rotate(3deg);
  }

  .sign-form {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  @media (min-width: 1536px) {
    .sign-form {
      gap: 20px;
    }
  }

  .gaming-input {
    background: white;
    font-family: "raleway", sans-serif;
    transition: all 0.2s ease;
  }

  .gaming-input:focus {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(52, 190, 237, 0.3);
  }

  /* Feuille de papier qui sort du bas */
  .paper-sheet {
    position: fixed;
    bottom: 0;
    left: 50%;
    transform: translate(-50%, 100%);
    width: 480px;
    max-height: 90vh;
    background: white;
    border-radius: 16px 16px 0 0;
    box-shadow:
      0 -20px 60px rgba(0, 0, 0, 0.4),
      inset 0 2px 0 rgba(255, 255, 255, 0.9);
    border: 3px solid var(--color-light-blue);
    border-bottom: none;
    z-index: 300;
    transition: transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
    overflow: hidden;
  }

  @media (min-width: 1536px) {
    .paper-sheet {
      width: 900px;
      border-radius: 20px 20px 0 0;
      border: 4px solid var(--color-light-blue);
    }
  }

  .paper-sheet.show {
    transform: translate(-50%, 0);
  }

  .paper-content {
    padding: 20px 24px;
    height: 100%;
    overflow-y: auto;
  }

  @media (min-width: 1536px) {
    .paper-content {
      padding: 40px 50px;
    }
  }

  .paper-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
    padding-bottom: 12px;
    border-bottom: 3px solid var(--color-light-blue);
  }

  @media (min-width: 1536px) {
    .paper-header {
      margin-bottom: 32px;
      padding-bottom: 20px;
      border-bottom: 4px solid var(--color-light-blue);
    }
  }

  .dezoom-btn-wrapper {
    position: relative;
    z-index: 500;
    transition: transform 0.2s ease;
  }

  .dezoom-btn-wrapper:hover {
    transform: scale(1.15) rotate(-5deg);
  }

  .paper-form {
    display: flex;
    flex-direction: column;
    gap: 14px;
  }

  @media (min-width: 1536px) {
    .paper-form {
      gap: 28px;
    }
  }

  .paper-input {
    background: white;
    font-family: "raleway", sans-serif;
    transition: all 0.2s ease;
  }

  .paper-input:focus {
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(52, 190, 237, 0.3);
  }

  /* Scrollbar pour la feuille */
  .paper-content::-webkit-scrollbar {
    width: 8px;
  }

  .paper-content::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 10px;
  }

  .paper-content::-webkit-scrollbar-thumb {
    background: var(--color-light-blue);
    border-radius: 10px;
  }

  .paper-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-dark-blue);
  }

  /* Hover des boutons submit */
  .gaming-submit-btn:hover,
  .paper-submit-btn:hover {
    background: white !important;
    color: var(--color-light-blue) !important;
    border-color: var(--color-light-blue) !important;
  }

  /* Animations définies dans animations.css */
</style>

<script>
  import { OverlayManager } from '../../scripts/overlay-manager';
  import { ContactFormManager } from '../../scripts/contact-form';
  
  let contactFormManager: ContactFormManager | null = null;

  function initContactOverlay() {
    const overlayManager = OverlayManager.getInstance();
    
    // Recréer le gestionnaire de formulaire à chaque fois pour éviter les références DOM obsolètes
    contactFormManager = new ContactFormManager();
    
    // Setup de l'overlay contact avec callback de fermeture
    overlayManager.setupOverlay('contact', {
      closeButtonSelector: '.contact-return-button',
      onClose: () => {
        // Fermer la feuille de papier si elle est ouverte
        if (contactFormManager) {
          contactFormManager.closePaperSheet();
        }
      }
    });
    
    // Synchroniser les formulaires mobile et desktop
    const mobileInputs = document.querySelectorAll('[data-sync]');
    mobileInputs.forEach(input => {
      input.addEventListener('input', (e) => {
        const target = e.target as HTMLInputElement | HTMLTextAreaElement;
        const syncName = target.getAttribute('data-sync');
        if (syncName) {
          // Synchroniser vers tous les autres champs avec le même nom
          const otherInputs = document.querySelectorAll(`[data-sync="${syncName}"]`);
          otherInputs.forEach(otherInput => {
            if (otherInput !== target) {
              (otherInput as HTMLInputElement | HTMLTextAreaElement).value = target.value;
            }
          });
        }
      });
    });
    
    // Gérer la soumission du formulaire mobile
    const mobileForm = document.getElementById('contact-form-mobile') as HTMLFormElement;
    if (mobileForm) {
      mobileForm.addEventListener('submit', (e) => {
        e.preventDefault();
        // Utiliser la même logique que le formulaire desktop
        if (contactFormManager) {
          contactFormManager.handleSubmit(e);
        }
      });
    }
  }

  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", initContactOverlay);
  } else {
    initContactOverlay();
  }

  document.addEventListener("astro:page-load", initContactOverlay);
</script>
